<!--Main Navigation-->
<admin-header [Status]=status></admin-header>
<!--Main Navigation-->

<!--Main layout-->
<main>
  <h5>Quản lý nhà phân phối</h5>
  <div class="container pt-4 main-layout">
    <div class="row">
      <div class="col-2">
        <span><p>Số nhà phân phối đang hoạt động: {{suppliersActive}}</p></span>
      </div>
      <div class="col-3">
        <button class="root-btn" (click)="openNew()">Thêm nhà phân phối</button>
      </div>
      <div class="col-2">
        <select class="form-select" aria-label="Default select example">
          <option value="1">Tất cả</option>
          <option value="2">Còn hợp tác</option>
          <option value="3">Ngừng hợp tác</option>
        </select>
      </div>
      <div class="col-5">
        <form (ngSubmit)="onSearch()" style="width: 100%">
          <div class="input-group mb-3">
            <input type="text" [(ngModel)]="search" name="name" class="form-control inputRoot" pInputText ngModel #username
                   placeholder="Nhập tên nhà phân phối...">
            <button class="buttonRoot" pButton pRipple icon="pi pi-search"></button>
          </div>
        </form>
      </div>
    </div>
    <!-- table -->
    <section class="table-account">
      <p-table class="table"  [value]="supplierResponse.supplierItems">
        <ng-template pTemplate="header">
          <tr>
            <th pSortableColumn="name-supplier" (mousedown)="sort('nameSup')">Tên <p-sortIcon field="name-supplier"></p-sortIcon></th>
            <th pSortableColumn="phone-number" (mousedown)="sort('phoneNumber')">Số điện thoại <p-sortIcon field="phone-number"></p-sortIcon></th>
            <th pSortableColumn="email" (mousedown)="sort('email')">Email <p-sortIcon field="email"></p-sortIcon></th>
            <th pSortableColumn="address" (mousedown)="sort('address')">Địa chỉ <p-sortIcon field="address"></p-sortIcon></th>
            <th pSortableColumn="create-date" (mousedown)="sort('createdDate')">Ngày gia nhập <p-sortIcon field="create-date"></p-sortIcon></th>
            <th>Trạng thái</th>
            <th scope="col">Thao tác</th>
          </tr>
        </ng-template>
        <ng-template pTemplate="body" let-distributor>
          <tr>
            <td>{{distributor.nameSup}}</td>
            <td>{{distributor.numberPhone}}</td>
            <td>{{distributor.email}}</td>
            <td>{{distributor.address}}</td>
            <td>{{distributor.createdDate | date}}</td>
            <td>
<!--              <div *ngIf="distributor.statusName === 'Avtive'" class="active">-->
<!--                <p>{{distributor.statusName}}</p>-->
<!--              </div>-->
<!--              <div *ngIf="!(distributor.statusName === 'Avtive')" class="in-active">-->
<!--                <p>{{distributor.statusName}}</p>-->
<!--              </div>-->
              <p>{{distributor.statusName}}</p>
            </td>
            <td>
              <i (click)="openUpdate(distributor.id)"  class="fa-solid fa-file-pen me-2"></i>
              <i (click)="delete(distributor.id)"  *ngIf="distributor.status == 1" class="fa-solid fa-trash"></i>
            </td>
          </tr>
        </ng-template>
      </p-table>
      <p-paginator [rows]="10" [totalRecords]="totalItems" [rowsPerPageOptions]="[10,25,50]" (onPageChange)="paginate($event)" ></p-paginator>
    </section>
  </div>

  <p-toast position="top-right"></p-toast>
  <p-confirmDialog header="Confirmation" icon="pi pi-exclamation-triangle"></p-confirmDialog>
  <admin-footer></admin-footer>
</main>
<!--Main layout-->

<p-dialog [(visible)]="supplierDialog" [style]="{width: '50vw'}" header="Thêm mới nhà cung cấp" [modal]="true" styleClass="p-fluid">
  <ng-template pTemplate="content">
    <div class="field mt-3">
      <label for="name">Name</label>
      <input type="text" pInputText id="name" [(ngModel)]="form.nameSup" required />
      <small class="p-error" *ngIf="submitted && !form.nameSup">Name is required.</small>
    </div>
    <div class="field mt-3">
      <label for="name">Number phone</label>
      <input type="text" pInputText id="numberphone" [(ngModel)]="form.numberPhone" required />
      <small class="p-error" *ngIf="submitted && !form.numberPhone">Number phone is required.</small>
    </div>
    <div class="field mt-3">
      <label for="Email">Email</label>
      <input type="text" pInputText id="email" [(ngModel)]="form.email" required />
      <small class="p-error" *ngIf="submitted && !form.email">Email is required.</small>
    </div>
    <div class="field mt-3">
      <label for="address" class="form-label">Địa chỉ</label>
      <textarea class="form-control" id="address" pInputTextarea [(ngModel)]="form.address" required rows="3"></textarea>
      <small class="p-error" *ngIf="submitted && !form.address">Address is required.</small>
    </div>

    <div class="mt-3 float-end">
      <button class="root-btn" (click)="saveSupplier()">Thêm mới</button>
    </div>
  </ng-template>
</p-dialog>

