<employee-header xmlns="http://www.w3.org/1999/html" [Status]="status"></employee-header>

<main>
  <div class="container-fluid pt-4 main-layout">
    <div class="row">
      <h5>Quản lý loại sản phẩm</h5>
    </div>
    <div class="row">
      <div class="col float-start">
        <button type="button" class="root-btn" (click)="showDialog()" label="Show">Thêm mới</button>
      </div>
      <div class="col">
        <form>
          <div class="input-group mb-3">
            <input type="text" name="phonenumber" class="form-control inputRoot" pInputText ngModel #name
                   placeholder="Nhập tên danh mục">
            <button type="button" class="buttonRoot" pButton pRipple
                    (mousedown)="searchByName(name.value)">
              <i class="fa-solid fa-magnifying-glass"></i>
            </button>
          </div>
        </form>
      </div>
    </div>
    <!-- table -->
    <section class="table-account">
      <p-treeTable #tt [value]="files.data" [columns]="cols">
        <ng-template pTemplate="header" let-columns>
          <tr>
            <th ttSortableColumn="name" (mousedown)="sort('name')">
              Tên danh mục
              <p-treeTableSortIcon field="name"></p-treeTableSortIcon>
            </th>
            <th ttSortableColumn="description" (mousedown)="sort('description')">
              Mô tả
              <p-treeTableSortIcon field="description"></p-treeTableSortIcon>
            </th>
            <th ttSortableColumn="statusName" (mousedown)="sort('statusName')">
              Trạng thái
              <p-treeTableSortIcon field="statusName"></p-treeTableSortIcon>
            </th>
            <th ttSortableColumn="amountProduct" (mousedown)="sort('amountProduct')">
              Số lượng hàng
              <p-treeTableSortIcon field="amountProduct"></p-treeTableSortIcon>
            </th>
            <th ttSortableColumn="creator" (mousedown)="sort('creator')">
              Người tạo
              <p-treeTableSortIcon field="creator"></p-treeTableSortIcon>
            </th>
            <th>
              Hành động
            </th>
          </tr>
        </ng-template>
        <ng-template pTemplate="body" let-rowNode let-rowData="rowData">
          <tr>
            <td >
              <p-treeTableToggler [rowNode]="rowNode"></p-treeTableToggler>
              {{rowData.name}}
            </td>
            <td ttEditableColumn>
              <p-treeTableCellEditor>
                <ng-template pTemplate="input">
                  <input pInputText type="text" >
                </ng-template>
                <ng-template pTemplate="output">{{rowData.description}}</ng-template>
              </p-treeTableCellEditor>
            </td>
            <td *ngIf="rowData.status==1">Active</td>
            <td *ngIf="rowData.status==2">Inactive</td>
            <td>{{rowData.amountProduct}}</td>
            <td ttEditableColumn>{{rowData.creator}}</td>
            <td>
              <button type="button" class="btn btn-primary m-1" (click)="showDialogDetail(rowData.id)">
                <i class="fa-solid fa-plus"></i>
              </button>
              <button type="button" class="btn btn-success m-1" (click)="showDialogDetailUpdate(rowData.id)">
                <i class="fa-solid fa-pencil"></i>
              </button>
              <button type="button" class="btn btn-danger m-1" (mousedown)="delete(rowData.id)">
                <i class="fa-solid fa-trash"></i>
              </button>
            </td>
          </tr>
        </ng-template>
      </p-treeTable>
      <p-paginator [rows]="10" [totalRecords]="files.totalItems" [rowsPerPageOptions]="[10,25,50]"
                   currentPageReportTemplate="Showing {{files.totalPages}} to {{files.totalPages}} of {{files.totalItems}} entries"
                   (onPageChange)="Pageable($event)"></p-paginator>
    </section>
  </div>
  <p-confirmDialog [style]="{width: '50vw'}" [baseZIndex]="10000"
                   rejectButtonStyleClass="p-button-text"></p-confirmDialog>
  <p-toast></p-toast>
  <employee-footer></employee-footer>
</main>

<p-dialog header="Thêm mới danh mục" [(visible)]="display" [modal]="true" [style]="{width: '50vw'}">
  <form>
    <div class="row">
      <div class="mb-3">
        <label for="name-category" class="form-label">Tên danh mục</label>
        <input [(ngModel)]="typeRequest.name" [ngModelOptions]="{standalone: true}" type="text"
               class="form-control" id="name-category">
      </div>
      <div class="mb-3">
        <label for="description-category" class="form-label">Mô tả</label>
        <textarea [(ngModel)]="typeRequest.description" [ngModelOptions]="{standalone: true}"
                  class="form-control" id="description-category" rows="3"></textarea>
      </div>
      <div class="mb-3" style="width: 300px;">
        <label class="form-label">Danh mục chính</label>
        <p-dropdown [options]="filesType.data" [(ngModel)]="category" [ngModelOptions]="{standalone: true}"
                    optionLabel="name" [filter]="true" filterBy="name" styleClass="dropdown-select">
          <ng-template pTemplate="selectedItem">
            <div class="country-item country-item-value" *ngIf="category">
              <div>{{category.name}}</div>
            </div>
          </ng-template>
          <ng-template let-category pTemplate="item">
            <div class="country-item">
              <div>{{category.name}}</div>
            </div>
          </ng-template>
        </p-dropdown>
      </div>

      <div class="row text-center">
        <div class="col">
          <button type="submit" class="root-btn me-2" (mousedown)="create()">
            Thêm mới
          </button>
          <button type="submit" class="btn btn-outline-primary">
            Hủy
          </button>
        </div>
      </div>
    </div>
  </form>
</p-dialog>

<p-dialog header="Xem thông tin chi tiết" [(visible)]="displaydetail" [modal]="true" [style]="{width: '50vw'}">
  <form>
    <div class="row">
      <div class="mb-3">
        <label for="detail-name-category" class="form-label">Tên danh mục</label>
        <input [(ngModel)]="typeDetailRequest.name" [ngModelOptions]="{standalone: true}" type="text"
               class="form-control" id="detail-name-category">
      </div>
      <div class="mb-3">
        <label for="detail-des-category" class="form-label">Mô tả</label>
        <textarea [(ngModel)]="typeDetailRequest.description" [ngModelOptions]="{standalone: true}"
                  class="form-control" id="detail-des-category" rows="3"></textarea>
      </div>
      <div class="row text-center">
        <div class="col">
          <button type="submit" class="root-btn me-2" (mousedown)="create()">
            Thêm mới
          </button>
          <button type="submit" class="btn btn-outline-primary">
            Hủy
          </button>
        </div>
      </div>
    </div>
  </form>
</p-dialog>

<p-dialog header="Chỉnh sửa thông tin danh mục" [(visible)]="updateType" [modal]="true" [style]="{width: '50vw'}">
  <form>
    <div class="row">
      <div class="mb-3">
        <label for="update-name-category" class="form-label">Tên danh mục</label>
        <input [(ngModel)]="updateTypeProductResponse.name" [ngModelOptions]="{standalone: true}" type="text"
               class="form-control" id="update-name-category">
      </div>
      <div class="mb-3">
        <label for="update-des-category" class="form-label">Mô tả</label>
        <textarea [(ngModel)]="updateTypeProductResponse.description" [ngModelOptions]="{standalone: true}"
                  class="form-control" id="update-des-category" rows="3"></textarea>
      </div>
      <div class="row text-center">
        <div class="col">
          <button type="submit" class="root-btn me-2" (mousedown)="create()">
            Thêm mới
          </button>
          <button type="submit" class="btn btn-outline-primary">
            Hủy
          </button>
        </div>
      </div>
    </div>
  </form>
</p-dialog>


